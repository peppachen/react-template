### React事件处理函数中状态更新是异步的

- React会将多个状态更新操作合并(批处理),在一次渲染中完成

```tsx
const [count, setCount] = useState(0);

function handleClick() {
  setCount(count + 1);
  console.log(count); // 可能仍然输出 0，因为更新是异步的
}
```

#### 为什么状态更新是异步的

#### 1. 性能优化

- React 将多个状态更新批量合并，减少不必要的渲染。

##### 2. 确保一致性

- 避免在单次事件中多次渲染，提高运行效率。

#### 如何获取最新值

##### 1. 函数式更新时

```tsx
setCount(prevCount => prevCount + 1);
```

##### 2. 借助useEffect

```tsx
useEffect(() => {
  console.log("状态更新后的值：", count);
}, [count]);
```

### 在非React控制的代码(如setTimeout、原生事件中)是同步更新的

```tsx
const [count, setCount] = useState(0);

setTimeout(() => {
  setCount(count + 1);
  console.log(count); // 输出更新后的值
}, 1000);
```

